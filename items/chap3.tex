\section{Нижние оценки на КНФ-кодировки функции четности}
В этой главе будут приведено доказательство Теоремы~\ref{thm:main}.
Главное свойство функции четности, которым мы будем пользоваться - это высокая чувствительность 
(каждое выполняющее означивание изолированно):
для всех $i \in [n]$ и всех $x,x' \in \{0,1\}^n$, которые отличаются только в $i$-ой позиции,
$\PAR(x) \neq \PAR(x')$.
Это обозначает, что если КНФ $F$ вычисляет $\PAR$ и $F(x) = 1$, то $F$ обязана содержать клоз, 
который выполняется только переменной $x_i$.
Как и в~\cite{DBLP:journals/cjtcs/PaturiPZ99}, назовем такой клоз критическим по отношению к $(x,i)$.
Эта обозначение естественно расширяется для КНФ-кодировки. Пусть $F(x, y)$ - это КНФ-кодировка функции четности.
Тогда для всех $(x, y)$ таких, что $F(x, y) = 1$, и всех $i \in [n]$ верно следующее: $F$ содержит клоз,
который станет невыполненным, если поменять значение бита $x_i$. 
Будем называть его критическим клозом по отношению к $(x, y, i)$.
\subsection{Ограниченное количество дополнительных переменных}
Для доказательства нижней оценки $m \ge \Omega((s+1)2^{n/(s+1)}/n)$, адаптируем доказательство нижней оценки $\Omega(n^{1/4}2^{\sqrt n})$ на схему глубины $3$, вычисляющую $\PAR_n$ 
от Патури, Пудлак и Зейн~\cite{DBLP:journals/cjtcs/PaturiPZ99}. 
Рассмотрим КНФ $F(x_1, \dotsc, x_n)$.
Для каждого изолированного выполняющего означивания~$x \in \{0,1\}^n$ функции $F$ и каждого~$i \in [n]$, зафиксируем самые короткий клоз по отношению к $(x,i)$ и обозначим его $C_{F,x,i}$.
Теперь для изолированного выполняющего означивания $x$, определим его вес по отношению к ~$F$, как 
\[w_F(x) = \sum\limits_{i=1}^n \frac{1}{|C_{F,x,i}|} \, .\]

\begin{lemma}[Лемма~5 из~\cite{DBLP:journals/cjtcs/PaturiPZ99}]\label{lemma:isolatedweight}
	Для всех~$\mu$ у $F$~может быть не более $2^{n - \mu}$ изолированных выполняющих означиваний 
	веса хотя бы $\mu$.
\end{lemma}

\begin{proof}[Доказательство~\eqref{eq:sm}, $m \ge \Omega\left(\frac{s+1}{n} \cdot 2^{n/(s+1)}\right)$]
	Пусть $F(x_1, \dotsc, x_n, y_1, \dotsc, y_s)$ - это КНФ-кодировка размера~$m$ функции $\PAR_n$. 
	Рассмотрим ее расширение:
	\[\PAR_n(x)=\bigvee_{j \in [2^s]} F_j(x) \, .\]
	
	Обобщим определение $C_{F,x,i}$ и $w(x)$ для КНФ с дополнительными переменными следующим образом. Пусть $x \in \PAR^{-1}_n(1)$
	и пусть $j \in [2^s]$ - самый маленький индекс такой, что $F_j(x)=1$.
	Для $i \in [n]$, положим $C'_{F,x,i}=C_{F_j,x,i}$ 
	(то есть мы просто берем первую $F_j$, для которой $x$  - это выполняющий набор, и рассматриваем ее критический клоз по отношению $(x,i)$).
	Тогда вес $w'_F(x)$ у~$x$ по отношению к~$F$ определяется как~$w_{F_j}(x)$.
	Ясно, что
	\[w'_F(x) = \sum_{i \in [n]} \frac{1}{|C'_{(F,x,i)}|} \,. \]
	Для $l \in [n]$, определим также $N_{l,F}(x)=|\{i \in [n] \colon |C'_{F,x,i}|=l\}|$
	- число критических клозов (по отношению к $x$) длины $l$.
	Отметим, что
	\begin{equation}\label{eq:weight}
		w'_F(x)=\sum_{l \in [n]}\frac{N_{l,F}(x)}{l} \, .
	\end{equation}
	
	
	Для некоторого параметра $0<\varepsilon<1$, который выберем позже, поделим $\PAR_n^{-1}(1)$
	на легкие и тяжелые части:
	\begin{align}
		H &= \{x \in \PAR_n^{-1}(1)  \colon w'_F(x) \ge s + 1 + \varepsilon\} \, ,\\
		L &= \{x \in \PAR_n^{-1}(1)  \colon w'_F(x) < s + 1 + \varepsilon\} \, .
	\end{align}
	Утверждается следующий факт: 
	\[|H| \le 2^s \cdot 2^{n-s-1-\varepsilon} \, .\]
	Проверим его. Для каждого $x \in H$, $w'_F(x)=w_{F_j}(x)$ для некоторого $j~\in~[2^s]$,
	и по Лемме~\ref{lemma:isolatedweight}, у $F_j$~не может быть больше, чем
	$2^{n-s-1-\varepsilon}$ изолированных выполняющих означиваний веса хотя бы
	$s+1+\varepsilon$. То есть
	\[\frac{|H|}{2^{n-s-1-\varepsilon}} \le 2^s \, .\]
	Что мы и хотели получить. \\
	С учетом того факта, что $|H|+|L|=|\PAR^{-1}_n(1)|=2^{n-1}$, имеем
	\begin{equation}\label{eq:lightsize}
		|L|=2^{n-1} -|H| \ge (1 - 2^{-\varepsilon})2^{n-1} \, .
	\end{equation}
	
	Пусть $F=\{C_1, \dotsc, C_m\}$. Для каждого $k \in [m]$, определим $C'_k \subseteq C_k$,
	как клоз~$C_k$ с удаленными дополнительными переменными. Тогда для всех
	$j \in [2^s]$, $F_j \subseteq \{C_1', \dotsc, C_m'\}$. Для $l \in [n]$,
	определим $m_l=|\{k \in [m] \colon |C'_k|=l\}|$, как число таких клозов длины~$l$.
	Рассмотрим клоз~$C'_k$
	и пусть $l=|C'_k|$. Тогда есть не больше $l2^{n-l}$ пар $(x,i)$,
	где $x \in \PAR^{-1}(1)$ и $i \in [n]$ таких, что $C'_{F,x,i}=C_k'$:
	есть не больше $l$ способов для выбора $i$, дальше выбрав $i$, 
	фиксируем значение всех $l$ литералов в~$C_k'$ 
	(всех эти литералы делаем равными $0$, кроме $i$-ого, который приравниваем к $1$), 
	и теперь есть не больше $2^{n-l}$ опций для выбора остальных битов в~$x$.
	Вспомнив, что $N_{l,F}(x)$ - это число критических клозов по отношению к~$x$ длины $l$, получаем:
	\[m_l \cdot l \cdot 2^{n - l} \ge \sum_{x \in \PAR^{-1}(1)} N_{F,l}(x) \ge \sum_{x \in L} N_{F,l}(x) \, .\]
	Тогда
	\begin{equation}\label{eq:cc}
		m =\sum_{l \in [n]}m_l \ge \sum_{l \in [n]}\frac{\sum_{x \in L} N_{F,l}(x)}{l2^{n-l}}=
		\sum_{x \in L} \sum_{l\in [n]} \frac{N_{F,l}(x)}{l2^{n-l}} =
		\sum_{x \in L} n2^{-n} \sum_{l \in [n]} \frac{N_{F,l}(x)}{n} \cdot \frac{2^l}{l} \, .
	\end{equation}
	Для оценки последней суммы заведем следующую функцию:
	\[T(x)=\sum_{l \in [n]} \frac{N_{F,l}(x)}{n} \cdot \frac{2^l}{l}=\sum_{l \in [n]} \frac{N_{F,l}(x)}{n}\cdot g(l)\,,\]
	где $g(l) = \frac{2^l}{l}$. Так как $g(l)$ - выпуклая (для $l>0$) и $\sum_{l \in [n]}\frac{N_{F,l}(x)}{n}=1$, то по~неравенству Йенсена получаем
	\begin{equation}\label{eq:aa}
		T(x) \ge g\left(\sum_{l \in [n]} \frac{N_{F,l}(x)}{n}\cdot l\right) \, .
	\end{equation}
	Теперь применяя неравенство Седракяна\footnote{Неравенство Седракяна - это частный случай неравенства Коши-Буняковского-Шварца: для всех $a_1, \dotsc, a_n \in \mathbb R$ и $b_1, \dotsc, b_n \in \mathbb{R}_{>0}$, $\sum_{i=1}^n a_i^2/b_i \ge \left(\sum_{i=1}^n a_i\right)^2/\sum_{i=1}^n b_i$.} (учитывая\eqref{eq:weight} и $\sum_{l \in [n]}N_{F,l}(x)=n$), имеем
	\begin{equation}\label{eq:bb}
		\sum_{l \in [n]} l N_{F,l}(x) = \sum_{l \in [n]} \frac{N_{F,l}^2(x)}{N_{F,l}(x) / l} \ge \frac{(\sum_{l \in [n]} N_{F,l}(x))^2}{\sum_{l \in [n]} N_{F,l}(x) / l} = \frac{n^2}{w'_F(x)} \, .
	\end{equation}
	Так как $g(l)$ монотонно возрастает при $l \ge 1/\ln 2$ и $w'_F(x)<s+1+\varepsilon$ для всех $x \in L$,
	комбинируя с\eqref{eq:aa}~и~\eqref{eq:bb}, получаем
	\begin{equation}\label{eq:tx}
		T(x) \ge g \left( \frac{n}{w'_F(x)}\right) \ge g \left( \frac{n}{s+1+\varepsilon}\right) \, ,
	\end{equation}
	для $s \le n\ln 2 - 1 -\varepsilon$.
	(Если $s > n\ln 2 - 1 -\varepsilon$, то нижняя оценка $m \ge \Omega(2^{n/(s+1)}/n)$ тривиальна.)\\
	%Plugging this into~\eqref{eq:cc} and combining with~\eqref{eq:lightsize}, gives
	Таким образом,
	\begin{align}
		m &\ge \sum_{x \in L}n2^{-n}T(x) \ge \tag{\ref{eq:cc}~and~\ref{eq:tx}}\\
		& \ge \sum_{x \in L}n2^{-n}g \left( \frac{n}{s+1+\varepsilon}\right)=\tag{definition of~$g$}\\
		&=|L|2^{-n}2^{\frac{n}{s+1+\varepsilon}}(s+1+\varepsilon) \ge\tag{\ref{eq:lightsize}}\\
		&\ge \left(\frac{1}{2} - \frac{1}{2^{\varepsilon + 1}}\right)(s + 1 + \varepsilon) 2^\frac{n}{s + 1 + \varepsilon}=\tag{rewriting}\\
		&=\left(\frac{1}{2} - \frac{1}{2^{\varepsilon + 1}}\right)(s + 1 + \varepsilon) 2^\frac{n}{s + 1} 2^{\frac{-n\varepsilon}{(s+1)(s+1+\varepsilon)}} \,.
	\end{align}
	Возьмем $\varepsilon=1/n$. Тогда,
	\[\left(\frac{1}{2} - \frac{1}{2^{\frac{1}{n} + 1}}\right) = \Theta \left( \frac{1}{n} \right)\,.\]
	Также верно, что
	\[\frac{1}{2} \le 2^{\frac{-1}{(s+1)(s+1+1/n)}} \le 1\,,\]
	так как $2^{-1/x}$ возрастает для $x>0$.
	В итоге получаем нижнюю оценку
	\[m \ge \Omega \left(\frac{s+1}{n} \cdot 2^{\frac{n}{s+1}} \right)\, .\]
\end{proof}
\subsection{Ширина дизъюнктов}
Для доказательства нижней оценки $k \ge n/(s+1)$ воспользуемся следующим следствием Satisfiability Coding Lemma.

\begin{lemma}[Лемма~2 из~\cite{DBLP:journals/cjtcs/PaturiPZ99}]\label{lemma:isolated}
	У любой $k$-КНФ $F(x_1, \dotsc, x_n)$ может быть не больше $2^{n - n/k}$ изолированных выполняющих означиваний.
\end{lemma}

\begin{proof}[Доказательство~\eqref{eq:sw}, $k \ge n/(s+1)$]
	Рассмотрим~$k$-КНФ $F(x_1, \dotsc, x_n, y_1, \dotsc, y_s)$, которая кодирует $\PAR_n$. Возьмем ее расширение до OR от $2^s$ $k$-КНФ:
	\[\PAR_n(x)=\bigvee_{j \in [2^s]} F_j(x) \, .\]
	По Лемме~\ref{lemma:isolated} у каждой $F_j$ не больше $2^{n - n/k}$ принимающих изолированных решений. Следовательно
	\[2^s \ge \frac{2^{n - 1}}{2^{n - n/k}} = 2^{n/k - 1}\]
	и, таким образом, $k \ge n/(s+1)$.
\end{proof}
\subsection{Неограниченное количество дополнительных переменных}
В этом разделе будет доказана нижняя оценка $m \ge 3n-9$.

\begin{proof}[Доказательство~\eqref{eq:m}, $m \ge 3n-9$]
	Доказательство будем проводить, используя индукцию по $n$.
	База: $n \le 3$ - очевидно.
	Индукционный переход: $n>3$. Рассмотрим КНФ-кодировку~$F(x_1, \dotsc, x_n, y_1, \dotsc, y_s)$ функции $\PAR_n$ с минимальным числом клозов. 
	Ниже будет показано, что можно найти $k$ детерминированных переменных (то есть обычных, не дополнительных) так, что после подстановки в эти переменные некоторые константы, число клозов уменьшится хотя бы на $3k$ (во всех случаях $k$ будет равно $1$ или $2$) . 
	Полученная функция будет вычислять $\PAR_{n-k}$ или ее отрицание.
	Не трудно показать, что минимальное число клозов в кодировке функции четности и в кодировки отрицания функции четности одинаково. Для этого изменим знаки всех детерминированных переменных в КНФ-кодировки (из $\PAR$ получится $\neg \PAR$ и наоборот).
	Таким образом, по индукционному предположению $F$ содержит хотя бы $3(n-k)-9+3k=3n-9$ клозов.

	Чтобы найти требуемые $k$ детерминированные переменные, мы разберем ряд случаев. В анализе, представленном ниже, под $d$-литералом будет подразумеваться литерал, который встречается ровно $d$~раз в $F$, под $d^+$ - литерал, который встречается хотя бы $d$~раз. $(d_1,d_2)$-литерал - тот, который встречается ровно $d_1$ раз положительно и $d_2$ раза отрицательно. Остальные типа литералов определяются аналогично. Будем рассматривать клоз, как множество литералов (которое не содержит вместе литерал и его отрицание), КНФ-формулу - как множество клозов.
	
	Заметим, что для всех $i \in [s]$, $y_i$ должен быть $(2^+,2^+)$-литералом. Действительно,
	если $y_i$ (или $\overline{y_i}$) - это ~$0$-литерал, то можно сделать подстановку $y_i \gets 0$
	($y_1 \gets 1$, соответственно). Не трудно видеть, что получившиеся формула все еще кодирует функцию $\PAR$. 
	Если $y_i$ - это~$(1,t)$-литерал, то можно 	
	удалить его, используя резолюцию: для всех пар клозов $C_0, C_1 \in F$ таких, что
	$\overline{y_i} \in C_0$ и $y_i \in C_1$, добавим клоз $C_0 \cup C_1 \setminus \{y_i, \overline{y_i}\}$ (если этот клоз содержит пару дополняющих литералов, то пропускаем его); затем удалим все клозы, содержащие $y_i$ или~$\overline{y_i}$. Результирующая формула все еще кодирует $\PAR_n$,
	но имеет меньший размер, чем $F$ (мы удалили $1+t$ клоз и добавили не больше $t$~клозов).
	
	В случаях, разобранных дальше, мы обозначили
	в качестве $l_i$  - литерал, соответствующий детерминированный переменной~$x_i$ или ее отрицанию~$\overline{x_i}$.
	\begin{enumerate}
		\item \emph{$F$~содержит $3^+$-литерал~$l_i$.} Подстановка $l_i \gets 1$ элиминирует хотя бы три клоза в~$F$.
		
		\item \emph{$F$~содержит $1$-литерал~$l_i$.} 
		Пусть $l_i \in C \in F$. $C$~не может содержать другие детерминированные переменные: 
		если $l_i, l_j \in C$ (для $i \neq j \in [n]$), рассмотрим $x \in \{0,1\}^n$ такой, что
		$\PAR_n(x)=1$ и $l_i=l_j=1$ (такой~$x$ существует начиная с $n > 3$), 
		и его расширение $y \in \{0,1\}^s$ такое, что $F(x,y)=1$; тогда, $F$~не содержит
		критического клоза по отношению к $(x,y,i)$. 
		Понятно, что $C$~не может содержать только одну переменную. 
		$C$ может содержать недетерминированную переменную~$y_j$.
		Рассмотрим $x \in \{0,1\}^n$ такой, что $\PAR_n(x)=1$ и $l_i=1$, 
		и его расширение $y \in \{0,1\}^s$ такое, что $F(x,y)=1$. 
		Если $y_j=1$, то $F$~не содержит критического клоза по отношению к $(x,y,i)$. 
		Тогда для любых $(x,y) \in \{0,1\}^{n+s}$ таких, что $F(x,y)=1$ и $l_i=1$, 
		будет следовать, что $y_j=0$. 
		Это наблюдение позволяет нам поступить следующим образом: 
		сначала сделаем подстановку $l_i \gets 1$, затем $y_j \gets 0$. 
		Первая подстановка выполнит клоз~$C$, вторая выполнит все клозы, содержащие $\overline{y_j}$. 
		Учитывая тот факт, что $y_i$ - $(2^+, 2^+)$-литерал, мы удалили хотя бы $3$ клоза.
		
		\item\label{case:three} \emph{Для всех $i \in [n]$, $x_i$ is a~$(2,2)$-литерал.} Если в $F$ не найдется клоза, содержащего хотя бы $2$ детерминированные переменные, 
		то $F$~содержит хотя бы $4n$ клозов, и в таком случае, все доказано.
		Рассмотрим клоз, содержащий две детерминированные переменные:
		пусть $l_i,l_j \in C_1 \in F$, где $i \neq j$.
		И пусть $C_2$ и $C_3$ - это клозы, которые содержат другие вхождения $l_i$ и $l_j$:
		$l_i \in C_2 \in F$ и $l_j \in C_3 \in F$ 
		($C_1 \neq C_2$ и $C_1 \neq C_3$, но может быть, что $C_2=C_3$).
		
		Предположим, что $C_2$ содержит другую детерминированную переменную: $l_k \in C_2$, где $k \neq i,j$.
		Рассмотрим $x \in \{0,1\}^n$ такой, что $\PAR_n(x)=1$ и $l_i=l_j=l_k=1$
		(такой $x$~существует, начиная с $n>3$), и его расширение $y \in \{0,1\}^s$ такое, что $F(x,y)=1$. Тогда $F$~не одержит критического клоза по отношению к $(x,y,i)$:
		$l_j$ выполняет $C_1$, $l_k$ выполняет $C_2$. 
		По похожим причинам $C_2$ не может содержать литерал~$l_j$. 
		Аналогично, $C_3$ не может содержать другие детерминированные переменные и литерал~$l_i$.
		(В тоже время, не исключено, что $\overline{l_j} \in C_2$ или
		$\overline{l_i} \in C_3$.)
		Теперь мы понимаем, что $C_2 \neq C_3$. 
		Отметим, что и~$C_2$ и~$C_3$ обязаны содержать хотя бы одну дополнительную переменную:
		иначе, можно было бы сделать подстановку только для $l_i$~и~$l_j$, получив, что $F$ ложна.
		
		\begin{enumerate}
			\item \emph{At~least one of~$C_2$ and~$C_3$ contains a~single non-deterministic variable.} Assume that it is~$C_2$:
			\[\{l_i,y_1\} \subseteq C_2 \subseteq \{l_i, \overline{l_j}, y_1\}\,. \]
			Assign $l_j \gets 1$. This eliminates two clauses: $C_1$ and $C_3$ are satisfied. Also, under this substitution, $C_2=\{l_i,y_1\}$ and $l_i$
			is a~$1$-literal. We claim that in any satisfying assignment of the resulting formula~$F'$, $l_i=\overline{y_1}$. Indeed, if $(x,y)$
			satisfies $F'$ and $l_i=y_1$, then $l_i=y_1=1$ (otherwise $C_2$
			is~falsified). But then there is no critical clause in~$F'$ w.r.t. $(x,y,i)$. Since in every satisfying assignment $l_i=\overline{y_1}$,
			we~can replace every occurrence of~$y_1$ ($\overline{y_1}$)
			by~$\overline{l_i}$ ($y_1$, respectively). This, in~particular, satisfies
			the clause~$C_2$.
			
			\item \emph{Both $C_2$ and $C_3$ contain at~least two non-deterministic variables:}
			\[
			\{l_i,\ l_j\} \subseteq C_1, \quad
			\{l_i,\ y_1,\ y_2\} \subseteq C_2, \quad
			\{l_j,\ y_3,\ y_4\} \subseteq C_3 \, .
			\]
			Here, $y_1$~and~$y_2$ are different variables, $y_3$~and~$y_4$ are also different, though it~is not excluded that some of $y_1$~and~$y_2$
			coincide with some of $y_3$~and~$y_4$. Let $Y \subseteq \{y_1, \dotsc, y_s\}$ be~non-deterministic variables appearing in~$C_2$ or~$C_3$.
			
			Recall that for every $(x,y) \in \{0,1\}^{n+s}$ such that $F(x,y)=1$ and $l_i=l_j = 1$, it holds that $y=0$ for all $y \in Y$. This means that
			if a~variable $y \in Y$ appears in both~$C_2$ and~$C_3$, then it has the same sign in~both clauses. Consider two subcases.
			
			\begin{enumerate}
				\item $Y=\{y_1,y_2\}$: \[\{l_i,\ l_j\} \subseteq C_1,\quad  \{l_i,\ y_1,\ y_2\} \subseteq C_2,\quad  \{l_j,\ y_1,\ y_2\} \subseteq C_3 \, .\]
				
				Assume that $\overline{y_1} \not \in C_1$. Assign $l_i \gets 1$, $l_j \gets 1$. Then, assigning $y_1 \gets 0$ eliminates at~least two clauses. Let~us show that there remains
				a~clause that contains $\overline{y_2}$. Consider $x \in \PAR_n^{-1} (1)$, such that $l_i = l_j = 1$, and its extension $y \in \{0, 1\}^s$, such $F(x, y) = 1$. We~know that $y_1$ and $y_2$ must
				be~equal to~$0$. However, flipping the value of~$y_2$ results
				in~a~satisfying assignment.
				Thus, it remains to analyze the following case: \[\{l_i,\ l_j, \overline{y_1}, \overline{y_2} \} \subseteq C_1, \quad               \{l_i,\ y_1,\ y_2\} \subseteq C_2, \quad
				\{l_j,\ y_1,\ y_2\} \subseteq C_3 \, .\]
				
				Assume that $\overline{l_j} \not \in C_2$ and $\overline{l_i} \not \in C_1$. Assign $l_i \gets 1$, then assign $y_1 \gets 0$ and $y_2 \gets 0$. Under this assignment, $C_3 = \{l_j\}$ (recall that $C_3$ cannot contain other deterministic variables, see Case~\ref{case:three}). This would mean that $l_j=1$ in~every satisfying assignment of the resulting CNF formula which cannot be~the case for a~CNF encoding of~parity.
				Thus, we~may assume that either $\overline{l_j} \in C_2$ or $\overline{l_i} \in C_1$. Without loss of~generality, assume that
				$\overline{l_j} \in C_2$.
				
				Let~us show that for every $(x, y) \in \{0, 1\}^{n + s}$, such that $F(x, y) = 1$ and $l_i = 1$, it~holds that $l_j \neq y_1$ and $l_j \neq y_2$. Indeed, if there is $(x, y) \in \{0, 1\}^{n + s}$ such that $F(x,y)=1$ and $l_i = l_j = 1$, then $y_1$ and $y_2$ must be equal to~$0$. If there is $(x, y) \in \{0, 1\}^{n + s}$, such that $F(x, y) = 1, l_i = 1, l_j = 0$, then $y_1$ and $y_2$ must be equal to~$0$, otherwise $F$~does not contain a~critical clause w.r.t. $(x, y, i)$. Thus, assigning $l_i \gets 1$ eliminates two clauses ($C_1$~and~$C_2$). We~then replace~$y_1$ and~$y_2$ with $\overline{l_j}$ and delete the clause~$C_3$.
				
				\item $|Y| \ge 3, \{y_1,y_2,y_3\} \subseteq Y$: \[\{l_i,\ l_j\} \subseteq C_1,\quad  \{l_i,\ y_1,\ y_2\} \subseteq C_2,\quad  \{l_j,\ y_1,\ y_3\} \subseteq C_3 \, .\]
				
				Assigning $l_i \gets 1, l_j \gets 1$ eliminates $C_1, C_2, C_3$. Assigning $y_1 \gets 0$ eliminates at least one more clause
				($y_1$ appears positively at least two times, but it~may appear in~$C_1$).
				There must be a~clause with $\overline{y_2}$ (otherwise we could assign $y_2 \gets 1$). Assigning $y_2 \gets 0$ eliminates at~least one more clause. Similarly, assigning $y_3 \gets 1$ eliminates another clause. In total, we eliminate at~least six clauses.
			\end{enumerate}
		\end{enumerate}
	\end{enumerate}
\end{proof}